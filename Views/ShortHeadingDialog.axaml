<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls"
        xmlns:helpers="clr-namespace:OpenccNetLibGui.Helpers"
        xmlns:viewModels="clr-namespace:OpenccNetLibGui.ViewModels"
        x:DataType="viewModels:ShortHeadingDialogViewModel"
        x:Class="OpenccNetLibGui.Views.ShortHeadingDialog"
        Width="450"
        Height="550"
        CanResize="False"
        WindowStartupLocation="CenterOwner"
        Title="Short heading settings">

    <Design.DataContext>
        <viewModels:ShortHeadingDialogViewModel />
    </Design.DataContext>

    <Window.Resources>
        <helpers:InverseBoolConverter x:Key="InverseBoolConverter" />
    </Window.Resources>

    <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto"
          Margin="18">

        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="4">
            <TextBlock Text="Short heading settings"
                       FontSize="14"
                       FontWeight="SemiBold" />

            <TextBlock Text="Maximum length: range 3–30 characters"
                       Foreground="{DynamicResource ThemeForegroundLowBrush}"
                       FontSize="12" />

            <TextBlock Text="Default: 8    •    Recommended: 5–15"
                       Foreground="{DynamicResource ThemeForegroundLowBrush}"
                       FontSize="12" />
        </StackPanel>

        <!-- Value + restore -->
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    Spacing="12"
                    Margin="0,14,0,0">
            <TextBlock Text="Value:" VerticalAlignment="Center" />

            <controls:NumericUpDown Width="120"
                                    MinHeight="28"
                                    FontSize="14"
                                    Minimum="3"
                                    Maximum="30"
                                    Increment="1"
                                    HorizontalContentAlignment="Center"
                                    VerticalContentAlignment="Center"
                                    Value="{Binding MaxLenValue, Mode=TwoWay}" />

            <TextBlock Text="Restore default (8)"
                       Foreground="{DynamicResource SystemAccentColor}"
                       FontSize="12"
                       VerticalAlignment="Center"
                       Cursor="Hand"
                       TextDecorations="Underline"
                       PointerPressed="RestoreDefault_Click" />
        </StackPanel>

        <!-- Pattern Allowed -->
        <Border Grid.Row="2"
                Margin="0,14,0,0"
                Padding="12"
                CornerRadius="10"
                BorderThickness="1"
                BorderBrush="{DynamicResource ThemeBorderLowBrush}">
            <StackPanel Spacing="8">
                <TextBlock Text="Pattern allowed:"
                           FontSize="13"
                           FontWeight="SemiBold" />

                <!-- CJK -->
                <CheckBox Content="All CJK characters"
                          IsChecked="{Binding AllCjk, Mode=TwoWay}" />

                <!-- ASCII (tri-state parent like VS Installer) -->
                <CheckBox Content="ASCII characters"
                          IsThreeState="True"
                          Margin="0,6,0,0"
                          IsChecked="{Binding AsciiState, Mode=TwoWay}" />

                <!-- ASCII digits only (child of ASCII) -->
                <CheckBox Content="ASCII digits only"
                          Margin="18,0,0,0"
                          IsChecked="{Binding AllAsciiDigits, Mode=TwoWay}" />

                <Separator Margin="0,8,0,2" />

                <!-- Mixed -->
                <CheckBox Content="Mixed CJK and ASCII characters"
                          IsChecked="{Binding MixedCjkAscii, Mode=TwoWay}" />
            </StackPanel>
        </Border>

        <!-- Advanced -->
        <Border Grid.Row="3"
                Margin="0,14,0,0"
                Padding="12"
                CornerRadius="10"
                BorderThickness="1"
                BorderBrush="{DynamicResource ThemeBorderLowBrush}">
            <StackPanel Spacing="8">
                <TextBlock Text="Advanced"
                           FontSize="13"
                           FontWeight="SemiBold" />

                <StackPanel Spacing="4">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="Custom Title Heading Regex"
                                   FontSize="12"
                                   Foreground="{DynamicResource ThemeForegroundLowBrush}" />

                        <TextBlock Text="Invalid regular expression"
                                   FontSize="11"
                                   Foreground="Red"
                                   IsVisible="{Binding IsCustomTitleHeadingRegexValid, Converter={StaticResource InverseBoolConverter}}" />
                    </StackPanel>

                    <TextBox MinHeight="30"
                             Watermark="(Optional) Leave blank to disable"
                             Text="{Binding CustomTitleHeadingRegex, Mode=TwoWay}" />

                    <TextBlock Text="Applied immediately after built-in title detection (before other heuristics)."
                               FontSize="11"
                               Foreground="{DynamicResource ThemeForegroundLowBrush}" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="4"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,12,0,0"
                    Spacing="10">
            <Button Content="Cancel"
                    Width="90"
                    FontWeight="SemiBold"
                    HorizontalContentAlignment="Center"
                    Click="Cancel_Click" />
            <Button Content="OK"
                    Width="90"
                    FontWeight="SemiBold"
                    HorizontalContentAlignment="Center"
                    IsDefault="True"
                    IsEnabled="{Binding IsCustomTitleHeadingRegexValid}"
                    Click="Ok_Click" />
        </StackPanel>

    </Grid>
</Window>